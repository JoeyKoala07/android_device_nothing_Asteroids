name: Device tree checks

on:
  push:
    branches: [ "Asteroids-user-14-UKQ1.241011.001-2507171803-release-keys" ]
  pull_request:
    branches: [ "Asteroids-user-14-UKQ1.241011.001-2507171803-release-keys" ]

jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Install shellcheck
      run: |
        sudo apt-get update
        sudo apt-get install -y shellcheck

    - name: Validate shell scripts
      run: |
        set -euo pipefail
        scripts=(extract-files.sh setup-makefiles.sh vendorsetup.sh)
        for script in "${scripts[@]}"; do
          if [[ -f "$script" ]]; then
            echo "Checking $script"
            bash -n "$script"
            shellcheck -x "$script"
          else
            echo "Skipping missing $script"
          fi
        done
